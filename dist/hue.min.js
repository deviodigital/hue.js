/**
 * ! hue.js Color Picker - v0.1 - 2018.03.24
 * https://github.com/deviodigital/hue.js
 * Copyright (c) 2018 Robert DeVore (c) 2014 Matt Wiebe; Licensed GPLv2
 */
(function($,undef){var _html,nonGradientIE,gradientType,vendorPrefixes,_css,hue,UA,isIE,IEVersion;_html='<div class="hue-picker"><div class="hue-picker-inner"><div class="hue-square"><a class="hue-square-value" href="#"><span class="hue-square-handle ui-slider-handle"></span></a><div class="hue-square-inner hue-square-horiz"></div><div class="hue-square-inner hue-square-vert"></div></div><div class="hue-slider hue-strip"><div class="hue-slider-offset"></div></div></div></div>';_css='.hue-picker{display:block;position:relative}.hue-picker,.hue-picker *{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input+.hue-picker{margin-top:4px}.hue-error{background-color:#ffafaf}.hue-border{border-radius:3px;border:1px solid #aaa;width:200px;background-color:#fff}.hue-picker-inner{position:absolute;top:0;right:0;left:0;bottom:0}.hue-border .hue-picker-inner{top:10px;right:10px;left:10px;bottom:10px}.hue-picker .hue-square-inner{position:absolute;left:0;right:0;top:0;bottom:0}.hue-picker .hue-square,.hue-picker .hue-slider,.hue-picker .hue-square-inner,.hue-picker .hue-palette{border-radius:3px;box-shadow:inset 0 0 5px rgba(0,0,0,.4);height:100%;width:12.5%;float:left;margin-right:5%}.hue-picker .hue-square{width:76%;margin-right:10%;position:relative}.hue-picker .hue-square-inner{width:auto;margin:0}.hue-ie-9 .hue-square,.hue-ie-9 .hue-slider,.hue-ie-9 .hue-square-inner,.hue-ie-9 .hue-palette{box-shadow:none;border-radius:0}.hue-ie-9 .hue-square,.hue-ie-9 .hue-slider,.hue-ie-9 .hue-palette{outline:1px solid rgba(0,0,0,.1)}.hue-ie-lt9 .hue-square,.hue-ie-lt9 .hue-slider,.hue-ie-lt9 .hue-square-inner,.hue-ie-lt9 .hue-palette{outline:1px solid #aaa}.hue-ie-lt9 .hue-square .ui-slider-handle{outline:1px solid #aaa;background-color:#fff;-ms-filter:"alpha(Opacity=30)"}.hue-ie-lt9 .hue-square .hue-square-handle{background:0 0;border:3px solid #fff;-ms-filter:"alpha(Opacity=50)"}.hue-picker .hue-strip{margin-right:0;position:relative}.hue-picker .hue-strip .ui-slider-handle{position:absolute;background:0 0;margin:0;right:-3px;left:-3px;border:4px solid #aaa;border-width:4px 3px;width:auto;height:6px;border-radius:4px;box-shadow:0 1px 2px rgba(0,0,0,.2);opacity:.9;z-index:5;cursor:ns-resize}.hue-strip .ui-slider-handle:before{content:" ";position:absolute;left:-2px;right:-2px;top:-3px;bottom:-3px;border:2px solid #fff;border-radius:3px}.hue-picker .hue-slider-offset{position:absolute;top:11px;left:0;right:0;bottom:-3px;width:auto;height:auto;background:transparent;border:0;border-radius:0}.hue-picker .hue-square-handle{background:transparent;border:5px solid #aaa;border-radius:50%;border-color:rgba(128,128,128,.5);box-shadow:none;width:12px;height:12px;position:absolute;left:-10px;top:-10px;cursor:move;opacity:1;z-index:10}.hue-picker .ui-state-focus .hue-square-handle{opacity:.8}.hue-picker .hue-square-handle:hover{border-color:#999}.hue-picker .hue-square-value:focus .hue-square-handle{box-shadow:0 0 2px rgba(0,0,0,.75);opacity:.8}.hue-picker .hue-square-handle:hover::after{border-color:#fff}.hue-picker .hue-square-handle::after{position:absolute;bottom:-4px;right:-4px;left:-4px;top:-4px;border:3px solid #f9f9f9;border-color:rgba(255,255,255,.8);border-radius:50%;content:" "}.hue-picker .hue-square-value{width:8px;height:8px;position:absolute}.hue-ie-lt9 .hue-square-value,.hue-mozilla .hue-square-value{width:1px;height:1px}.hue-palette-container{position:absolute;bottom:0;left:0;margin:0;padding:0}.hue-border .hue-palette-container{left:10px;bottom:10px}.hue-picker .hue-palette{margin:0;cursor:pointer}.hue-square-handle,.ui-slider-handle{border:0;outline:0}';UA=navigator.userAgent.toLowerCase();isIE=navigator.appName==='Microsoft Internet Explorer';IEVersion=isIE?parseFloat(UA.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;nonGradientIE=(isIE&&IEVersion<10);gradientType=!1;vendorPrefixes=['-moz-','-webkit-','-o-','-ms-'];if(nonGradientIE&&IEVersion<=7){$.fn.hue=$.noop;$.support.hue=!1;return}
$.support.hue=!0;function testGradientType(){var el,base,bgImageString='backgroundImage';if(nonGradientIE){gradientType='filter'}
else{el=$('<div id="hue-gradtest" />');base='linear-gradient(top,#fff,#000)';$.each(vendorPrefixes,function(i,val){el.css(bgImageString,val+base);if(el.css(bgImageString).match('gradient')){gradientType=i;return!1}});if(gradientType===!1){el.css('background','-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))');if(el.css(bgImageString).match('gradient')){gradientType='webkit'}}
el.remove()}}
function createGradient(origin,stops){origin=(origin==='top')?'top':'left';stops=$.isArray(stops)?stops:Array.prototype.slice.call(arguments,1);if(gradientType==='webkit'){return legacyWebkitGradient(origin,stops)}else{return vendorPrefixes[gradientType]+'linear-gradient('+origin+', '+stops.join(', ')+')'}}
function stupidIEGradient(origin,stops){var type,self,lastIndex,filter,startPosProp,endPosProp,dimensionProp,template,html;origin=(origin==='top')?'top':'left';stops=$.isArray(stops)?stops:Array.prototype.slice.call(arguments,1);type=(origin==='top')?0:1;self=$(this);lastIndex=stops.length-1;filter='filter';startPosProp=(type===1)?'left':'top';endPosProp=(type===1)?'right':'bottom';dimensionProp=(type===1)?'height':'width';template='<div class="hue-ie-gradient-shim" style="position:absolute;'+dimensionProp+':100%;'+startPosProp+':%start%;'+endPosProp+':%end%;'+filter+':%filter%;" data-color:"%color%"></div>';html='';if(self.css('position')==='static'){self.css({position:'relative'})}
stops=fillColorStops(stops);$.each(stops,function(i,startColor){var endColor,endStop,filterVal;if(i===lastIndex){return!1}
endColor=stops[i+1];if(startColor.stop===endColor.stop){return}
endStop=100-parseFloat(endColor.stop)+'%';startColor.octoHex=new Color(startColor.color).toIEOctoHex();endColor.octoHex=new Color(endColor.color).toIEOctoHex();filterVal='progid:DXImageTransform.Microsoft.Gradient(GradientType='+type+', StartColorStr=\''+startColor.octoHex+'\', EndColorStr=\''+endColor.octoHex+'\')';html+=template.replace('%start%',startColor.stop).replace('%end%',endStop).replace('%filter%',filterVal)});self.find('.hue-ie-gradient-shim').remove();$(html).prependTo(self)}
function legacyWebkitGradient(origin,colorList){var stops=[];origin=(origin==='top')?'0% 0%,0% 100%,':'0% 100%,100% 100%,';colorList=fillColorStops(colorList);$.each(colorList,function(i,val){stops.push('color-stop('+(parseFloat(val.stop)/100)+', '+val.color+')')});return'-webkit-gradient(linear,'+origin+stops.join(',')+')'}
function fillColorStops(colorList){var colors=[],percs=[],newColorList=[],lastIndex=colorList.length-1;$.each(colorList,function(index,val){var color=val,perc=!1,match=val.match(/1?[0-9]{1,2}%$/);if(match){color=val.replace(/\s?1?[0-9]{1,2}%$/,'');perc=match.shift()}
colors.push(color);percs.push(perc)});if(percs[0]===!1){percs[0]='0%'}
if(percs[lastIndex]===!1){percs[lastIndex]='100%'}
percs=backFillColorStops(percs);$.each(percs,function(i){newColorList[i]={color:colors[i],stop:percs[i]}});return newColorList}
function backFillColorStops(stops){var first=0,last=stops.length-1,i=0,foundFirst=!1,incr,steps,step,firstVal;if(stops.length<=2||$.inArray(!1,stops)<0){return stops}
while(i<stops.length-1){if(!foundFirst&&stops[i]===!1){first=i-1;foundFirst=!0}else if(foundFirst&&stops[i]!==!1){last=i;i=stops.length}
i++}
steps=last-first;firstVal=parseInt(stops[first].replace('%'),10);incr=(parseFloat(stops[last].replace('%'))-firstVal)/steps;i=first+1;step=1;while(i<last){stops[i]=(firstVal+(step*incr))+'%';step++;i++}
return backFillColorStops(stops)}
$.fn.gradient=function(){var args=arguments;return this.each(function(){if(nonGradientIE){stupidIEGradient.apply(this,args)}else{$(this).css('backgroundImage',createGradient.apply(this,args))}})};$.fn.raninbowGradient=function(origin,args){var opts,template,i,steps;origin=origin||'top';opts=$.extend({},{s:100,l:50},args);template='hsl(%h%,'+opts.s+'%,'+opts.l+'%)';i=0;steps=[];while(i<=360){steps.push(template.replace('%h%',i));i+=30}
return this.each(function(){$(this).gradient(origin,steps)})};hue={options:{color:!1,mode:'hsl',controls:{horiz:'s',vert:'l',strip:'h'},hide:!0,border:!0,target:!1,width:200,palettes:!1},_color:'',_palettes:['#000','#fff','#d33','#d93','#ee2','#81d742','#1e73be','#8224e3'],_inited:!1,_defaultHSLControls:{horiz:'s',vert:'l',strip:'h'},_defaultHSVControls:{horiz:'h',vert:'v',strip:'s'},_scale:{h:360,s:100,l:100,v:100},_create:function(){var self=this,el=self.element,color=self.options.color||el.val();if(gradientType===!1){testGradientType()}
if(el.is('input')){if(self.options.target){if(typeof(self.options.target)==='function'){self.picker=$(_html).appendTo(self.options.target(el))}else{self.picker=$(_html).appendTo(self.options.target)}}else{self.picker=$(_html).insertAfter(el)}
self._addInputListeners(el)}else{el.append(_html);self.picker=el.find('.hue-picker')}
if(isIE){if(IEVersion===9){self.picker.addClass('hue-ie-9')}else if(IEVersion<=8){self.picker.addClass('hue-ie-lt9')}}else if(UA.indexOf('compatible')<0&&UA.indexOf('khtml')<0&&UA.match(/mozilla/)){self.picker.addClass('hue-mozilla')}
if(self.options.palettes){self._addPalettes()}
self._color=new Color(color).setHSpace(self.options.mode);self.options.color=self._color.toString();self.controls={square:self.picker.find('.hue-square'),squareDrag:self.picker.find('.hue-square-value'),horiz:self.picker.find('.hue-square-horiz'),vert:self.picker.find('.hue-square-vert'),strip:self.picker.find('.hue-strip'),stripSlider:self.picker.find('.hue-strip .hue-slider-offset')};if(self.options.mode==='hsv'&&self._has('l',self.options.controls)){self.options.controls=self._defaultHSVControls}else if(self.options.mode==='hsl'&&self._has('v',self.options.controls)){self.options.controls=self._defaultHSLControls}
self.hue=self._color.h();if(self.options.hide){self.picker.hide()}
if(self.options.border){self.picker.addClass('hue-border')}
self._initControls();self.active='external';self._dimensions();self._change()},_has:function(needle,haystack){var ret=!1;$.each(haystack,function(i,v){if(needle===v){ret=!0;return!1}});return ret},_addPalettes:function(){var container=$('<div class="hue-palette-container" />'),palette=$('<a class="hue-palette" tabindex="0" />'),colors=$.isArray(this.options.palettes)?this.options.palettes:this._palettes;if(this.picker.find('.hue-palette-container').length){container=this.picker.find('.hue-palette-container').detach().html('')}
$.each(colors,function(index,val){palette.clone().data('color',val).css('backgroundColor',val).appendTo(container).height(10).width(10)});this.picker.append(container)},_paint:function(){var self=this;self._paintDimension('top','strip');self._paintDimension('top','vert');self._paintDimension('left','horiz')},_paintDimension:function(origin,control){var self=this,c=self._color,mode=self.options.mode,color=self._getHSpaceColor(),target=self.controls[control],controlOpts=self.options.controls,stops;if(control===self.active||(self.active==='square'&&control!=='strip')){return}
switch(controlOpts[control]){case 'h':if(mode==='hsv'){color=c.clone();switch(control){case 'horiz':color[controlOpts.vert](100);break;case 'vert':color[controlOpts.horiz](100);break;case 'strip':color.setHSpace('hsl');break}
stops=color.toHsl()}else{if(control==='strip'){stops={s:color.s,l:color.l}}else{stops={s:100,l:color.l}}}
target.raninbowGradient(origin,stops);break;case 's':if(mode==='hsv'){if(control==='vert'){stops=[c.clone().a(0).s(0).toCSS('rgba'),c.clone().a(1).s(0).toCSS('rgba')]}else if(control==='strip'){stops=[c.clone().s(100).toCSS('hsl'),c.clone().s(0).toCSS('hsl')]}else if(control==='horiz'){stops=['#fff','hsl('+color.h+',100%,50%)']}}else{if(control==='vert'&&self.options.controls.horiz==='h'){stops=['hsla(0, 0%, '+color.l+'%, 0)','hsla(0, 0%, '+color.l+'%, 1)']}else{stops=['hsl('+color.h+',0%,50%)','hsl('+color.h+',100%,50%)']}}
target.gradient(origin,stops);break;case 'l':if(control==='strip'){stops=['hsl('+color.h+',100%,100%)','hsl('+color.h+', '+color.s+'%,50%)','hsl('+color.h+',100%,0%)']}else{stops=['#fff','rgba(255,255,255,0) 50%','rgba(0,0,0,0) 50%','rgba(0,0,0,1)']}
target.gradient(origin,stops);break;case 'v':if(control==='strip'){stops=[c.clone().v(100).toCSS(),c.clone().v(0).toCSS()]}else{stops=['rgba(0,0,0,0)','#000']}
target.gradient(origin,stops);break;default:break}},_getHSpaceColor:function(){return(this.options.mode==='hsv')?this._color.toHsv():this._color.toHsl()},_dimensions:function(reset){var self=this,opts=self.options,controls=self.controls,square=controls.square,strip=self.picker.find('.hue-strip'),squareWidth='77.5%',stripWidth='12%',totalPadding=20,innerWidth=opts.border?opts.width-totalPadding:opts.width,controlsHeight,paletteCount=$.isArray(opts.palettes)?opts.palettes.length:self._palettes.length,paletteMargin,paletteWidth,paletteContainerWidth;if(reset){square.css('width','');strip.css('width','');self.picker.css({width:'',height:''})}
squareWidth=innerWidth*(parseFloat(squareWidth)/100);stripWidth=innerWidth*(parseFloat(stripWidth)/100);controlsHeight=opts.border?squareWidth+totalPadding:squareWidth;square.width(squareWidth).height(squareWidth);strip.height(squareWidth).width(stripWidth);self.picker.css({width:opts.width,height:controlsHeight});if(!opts.palettes){return self.picker.css('paddingBottom','')}
paletteMargin=squareWidth*2/100;paletteContainerWidth=squareWidth-((paletteCount-1)*paletteMargin);paletteWidth=paletteContainerWidth/paletteCount;self.picker.find('.hue-palette').each(function(i){var margin=i===0?0:paletteMargin;$(this).css({width:paletteWidth,height:paletteWidth,marginLeft:margin})});self.picker.css('paddingBottom',paletteWidth+paletteMargin);strip.height(paletteWidth+paletteMargin+squareWidth)},_addInputListeners:function(input){var self=this,debounceTimeout=100,callback=function(event){var color=new Color(input.val()),val=input.val().replace(/^#/,'');input.removeClass('hue-error');if(color.error){if(val!==''){input.addClass('hue-error')}}else{if(color.toString()!==self._color.toString()){if(!(event.type==='keyup'&&val.match(/^[0-9a-fA-F]{3}$/))){self._setOption('color',color.toString())}}}};input.on('change',callback).on('keyup',self._debounce(callback,debounceTimeout));if(self.options.hide){input.one('focus',function(){self.show()})}},_initControls:function(){var self=this,controls=self.controls,square=controls.square,controlOpts=self.options.controls,stripScale=self._scale[controlOpts.strip];controls.stripSlider.slider({orientation:'vertical',max:stripScale,slide:function(event,ui){self.active='strip';if(controlOpts.strip==='h'){ui.value=stripScale-ui.value}
self._color[controlOpts.strip](ui.value);self._change.apply(self,arguments)}});controls.squareDrag.draggable({containment:controls.square.find('.hue-square-inner'),zIndex:1000,cursor:'move',drag:function(event,ui){self._squareDrag(event,ui)},start:function(){square.addClass('hue-dragging');$(this).addClass('ui-state-focus')},stop:function(){square.removeClass('hue-dragging');$(this).removeClass('ui-state-focus')}}).on('mousedown mouseup',function(event){var focusClass='ui-state-focus';event.preventDefault();if(event.type==='mousedown'){self.picker.find('.'+focusClass).removeClass(focusClass).blur();$(this).addClass(focusClass).focus()}else{$(this).removeClass(focusClass)}}).on('keydown',function(event){var container=controls.square,draggable=controls.squareDrag,position=draggable.position(),distance=self.options.width/100;if(event.altKey){distance*=10}
switch(event.keyCode){case 37:position.left-=distance;break;case 38:position.top-=distance;break;case 39:position.left+=distance;break;case 40:position.top+=distance;break;default:return!0}
position.left=Math.max(0,Math.min(position.left,container.width()));position.top=Math.max(0,Math.min(position.top,container.height()));draggable.css(position);self._squareDrag(event,{position:position});event.preventDefault()});square.mousedown(function(event){var squareOffset,pos;if(event.which!==1){return}
if(!$(event.target).is('div')){return}
squareOffset=self.controls.square.offset();pos={top:event.pageY-squareOffset.top,left:event.pageX-squareOffset.left};event.preventDefault();self._squareDrag(event,{position:pos});event.target=self.controls.squareDrag.get(0);self.controls.squareDrag.css(pos).trigger(event)});if(self.options.palettes){self._paletteListeners()}},_paletteListeners:function(){var self=this;self.picker.find('.hue-palette-container').on('click.palette','.hue-palette',function(){self._color.fromCSS($(this).data('color'));self.active='external';self._change()}).on('keydown.palette','.hue-palette',function(event){if(!(event.keyCode===13||event.keyCode===32)){return!0}
event.stopPropagation();$(this).click()})},_squareDrag:function(event,ui){var self=this,controlOpts=self.options.controls,dimensions=self._squareDimensions(),vertVal=Math.round((dimensions.h-ui.position.top)/dimensions.h*self._scale[controlOpts.vert]),horizVal=self._scale[controlOpts.horiz]-Math.round((dimensions.w-ui.position.left)/dimensions.w*self._scale[controlOpts.horiz]);self._color[controlOpts.horiz](horizVal)[controlOpts.vert](vertVal);self.active='square';self._change.apply(self,arguments)},_setOption:function(key,value){var self=this,oldValue=self.options[key],doDimensions=!1,hexLessColor,newColor,method;self.options[key]=value;switch(key){case 'color':value=''+value;hexLessColor=value.replace(/^#/,'');newColor=new Color(value).setHSpace(self.options.mode);if(newColor.error){self.options[key]=oldValue}else{self._color=newColor;self.options.color=self.options[key]=self._color.toString();self.active='external';self._change()}
break;case 'palettes':doDimensions=!0;if(value){self._addPalettes()}else{self.picker.find('.hue-palette-container').remove()}
if(!oldValue){self._paletteListeners()}
break;case 'width':doDimensions=!0;break;case 'border':doDimensions=!0;method=value?'addClass':'removeClass';self.picker[method]('hue-border');break;case 'mode':case 'controls':if(oldValue===value){return}
method=self.element;oldValue=self.options;oldValue.hide=!self.picker.is(':visible');self.destroy();self.picker.remove();return $(self.element).hue(oldValue)}
if(doDimensions){self._dimensions(!0)}},_squareDimensions:function(forceRefresh){var square=this.controls.square,dimensions,control;if(forceRefresh!==undef&&square.data('dimensions')){return square.data('dimensions')}
control=this.controls.squareDrag;dimensions={w:square.width(),h:square.height()};square.data('dimensions',dimensions);return dimensions},_isNonHueControl:function(active,type){if(active==='square'&&this.options.controls.strip==='h'){return!0}else if(type==='external'||(type==='h'&&active==='strip')){return!1}
return!0},_change:function(){var self=this,controls=self.controls,color=self._getHSpaceColor(),actions=['square','strip'],controlOpts=self.options.controls,type=controlOpts[self.active]||'external',oldHue=self.hue;if(self.active==='strip'){actions=[]}else if(self.active!=='external'){actions.pop()}
$.each(actions,function(index,item){var value,dimensions,cssObj;if(item!==self.active){switch(item){case 'strip':value=(controlOpts.strip==='h')?self._scale[controlOpts.strip]-color[controlOpts.strip]:color[controlOpts.strip];controls.stripSlider.slider('value',value);break;case 'square':dimensions=self._squareDimensions();cssObj={left:color[controlOpts.horiz]/self._scale[controlOpts.horiz]*dimensions.w,top:dimensions.h-(color[controlOpts.vert]/self._scale[controlOpts.vert]*dimensions.h)};self.controls.squareDrag.css(cssObj);break}}});if(color.h!==oldHue&&self._isNonHueControl(self.active,type)){self._color.h(oldHue)}
self.hue=self._color.h();self.options.color=self._color.toString();if(self._inited){self._trigger('change',{type:self.active},{color:self._color})}
if(self.element.is(':input')&&!self._color.error){self.element.removeClass('hue-error');if(self.element.val()!==self._color.toString()){self.element.val(self._color.toString())}}
self._paint();self._inited=!0;self.active=!1},_debounce:function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments,later,callNow;later=function(){timeout=null;if(!immediate){result=func.apply(context,args)}};callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args)}
return result}},show:function(){this.picker.show()},hide:function(){this.picker.hide()},toggle:function(){this.picker.toggle()},color:function(newColor){if(newColor===!0){return this._color.clone()}else if(newColor===undef){return this._color.toString()}
this.option('color',newColor)}};$.widget('a8c.hue',hue);$('<style id="hue-css">'+_css+'</style>').appendTo('head')}(jQuery));(function(global,undef){var Color=function(color,type){if(!(this instanceof Color))
return new Color(color,type);return this._init(color,type)};Color.fn=Color.prototype={_color:0,_alpha:1,error:!1,_hsl:{h:0,s:0,l:0},_hsv:{h:0,s:0,v:0},_hSpace:'hsl',_init:function(color){var func='noop';switch(typeof color){case 'object':if(color.a!==undef)
this.a(color.a);func=(color.r!==undef)?'fromRgb':(color.l!==undef)?'fromHsl':(color.v!==undef)?'fromHsv':func;return this[func](color);case 'string':return this.fromCSS(color);case 'number':return this.fromInt(parseInt(color,10))}
return this},_error:function(){this.error=!0;return this},clone:function(){var newColor=new Color(this.toInt()),copy=['_alpha','_hSpace','_hsl','_hsv','error'];for(var i=copy.length-1;i>=0;i--){newColor[copy[i]]=this[copy[i]]}
return newColor},setHSpace:function(space){this._hSpace=(space==='hsv')?space:'hsl';return this},noop:function(){return this},fromCSS:function(color){var list,leadingRE=/^(rgb|hs(l|v))a?\(/;this.error=!1;color=color.replace(/^\s+/,'').replace(/\s+$/,'').replace(/;$/,'');if(color.match(leadingRE)&&color.match(/\)$/)){list=color.replace(/(\s|%)/g,'').replace(leadingRE,'').replace(/,?\);?$/,'').split(',');if(list.length<3)
return this._error();if(list.length===4){this.a(parseFloat(list.pop()));if(this.error)
return this}
for(var i=list.length-1;i>=0;i--){list[i]=parseInt(list[i],10);if(isNaN(list[i]))
return this._error()}
if(color.match(/^rgb/)){return this.fromRgb({r:list[0],g:list[1],b:list[2]})}else if(color.match(/^hsv/)){return this.fromHsv({h:list[0],s:list[1],v:list[2]})}else{return this.fromHsl({h:list[0],s:list[1],l:list[2]})}}else{return this.fromHex(color)}},fromRgb:function(rgb,preserve){if(typeof rgb!=='object'||rgb.r===undef||rgb.g===undef||rgb.b===undef)
return this._error();this.error=!1;return this.fromInt(parseInt((rgb.r<<16)+(rgb.g<<8)+rgb.b,10),preserve)},fromHex:function(color){color=color.replace(/^#/,'').replace(/^0x/,'');if(color.length===3){color=color[0]+color[0]+color[1]+color[1]+color[2]+color[2]}
this.error=!/^[0-9A-F]{6}$/i.test(color);return this.fromInt(parseInt(color,16))},fromHsl:function(hsl){var r,g,b,q,p,h,s,l;if(typeof hsl!=='object'||hsl.h===undef||hsl.s===undef||hsl.l===undef)
return this._error();this._hsl=hsl;this._hSpace='hsl';h=hsl.h/360;s=hsl.s/100;l=hsl.l/100;if(s===0){r=g=b=l}
else{q=l<0.5?l*(1+s):l+s-l*s;p=2*l-q;r=this.hue2rgb(p,q,h+1/3);g=this.hue2rgb(p,q,h);b=this.hue2rgb(p,q,h-1/3)}
return this.fromRgb({r:r*255,g:g*255,b:b*255},!0)},fromHsv:function(hsv){var h,s,v,r,g,b,i,f,p,q,t;if(typeof hsv!=='object'||hsv.h===undef||hsv.s===undef||hsv.v===undef)
return this._error();this._hsv=hsv;this._hSpace='hsv';h=hsv.h/360;s=hsv.s/100;v=hsv.v/100;i=Math.floor(h*6);f=h*6-i;p=v*(1-s);q=v*(1-f*s);t=v*(1-(1-f)*s);switch(i%6){case 0:r=v;g=t;b=p;break;case 1:r=q;g=v;b=p;break;case 2:r=p;g=v;b=t;break;case 3:r=p;g=q;b=v;break;case 4:r=t;g=p;b=v;break;case 5:r=v;g=p;b=q;break}
return this.fromRgb({r:r*255,g:g*255,b:b*255},!0)},fromInt:function(color,preserve){this._color=parseInt(color,10);if(isNaN(this._color))
this._color=0;if(this._color>16777215)
this._color=16777215;else if(this._color<0)
this._color=0;if(preserve===undef){this._hsv.h=this._hsv.s=this._hsl.h=this._hsl.s=0}
return this},hue2rgb:function(p,q,t){if(t<0){t+=1}
if(t>1){t-=1}
if(t<1/6){return p+(q-p)*6*t}
if(t<1/2){return q}
if(t<2/3){return p+(q-p)*(2/3-t)*6}
return p},toString:function(){var hex=parseInt(this._color,10).toString(16);if(this.error)
return'';if(hex.length<6){for(var i=6-hex.length-1;i>=0;i--){hex='0'+hex}}
return'#'+hex},toCSS:function(type,alpha){type=type||'hex';alpha=parseFloat(alpha||this._alpha);switch(type){case 'rgb':case 'rgba':var rgb=this.toRgb();if(alpha<1){return"rgba( "+rgb.r+", "+rgb.g+", "+rgb.b+", "+alpha+" )"}
else{return"rgb( "+rgb.r+", "+rgb.g+", "+rgb.b+" )"}
break;case 'hsl':case 'hsla':var hsl=this.toHsl();if(alpha<1){return"hsla( "+hsl.h+", "+hsl.s+"%, "+hsl.l+"%, "+alpha+" )"}
else{return"hsl( "+hsl.h+", "+hsl.s+"%, "+hsl.l+"% )"}
break;default:return this.toString()}},toRgb:function(){return{r:255&(this._color>>16),g:255&(this._color>>8),b:255&(this._color)}},toHsl:function(){var rgb=this.toRgb();var r=rgb.r/255,g=rgb.g/255,b=rgb.b/255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+min)/2;if(max===min){h=s=0}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}
h/=6}
h=Math.round(h*360);if(h===0&&this._hsl.h!==h){h=this._hsl.h}
s=Math.round(s*100);if(s===0&&this._hsl.s){s=this._hsl.s}
return{h:h,s:s,l:Math.round(l*100)}},toHsv:function(){var rgb=this.toRgb();var r=rgb.r/255,g=rgb.g/255,b=rgb.b/255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,v=max;var d=max-min;s=max===0?0:d/max;if(max===min){h=s=0}else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}
h/=6}
h=Math.round(h*360);if(h===0&&this._hsv.h!==h){h=this._hsv.h}
s=Math.round(s*100);if(s===0&&this._hsv.s){s=this._hsv.s}
return{h:h,s:s,v:Math.round(v*100)}},toInt:function(){return this._color},toIEOctoHex:function(){var hex=this.toString();var AA=parseInt(255*this._alpha,10).toString(16);if(AA.length===1){AA='0'+AA}
return'#'+AA+hex.replace(/^#/,'')},toLuminosity:function(){var rgb=this.toRgb();return 0.2126*Math.pow(rgb.r/255,2.2)+0.7152*Math.pow(rgb.g/255,2.2)+0.0722*Math.pow(rgb.b/255,2.2)},getDistanceLuminosityFrom:function(color){if(!(color instanceof Color)){throw 'getDistanceLuminosityFrom requires a Color object'}
var lum1=this.toLuminosity();var lum2=color.toLuminosity();if(lum1>lum2){return(lum1+0.05)/(lum2+0.05)}
else{return(lum2+0.05)/(lum1+0.05)}},getMaxContrastColor:function(){var lum=this.toLuminosity();var hex=(lum>=0.5)?'000000':'ffffff';return new Color(hex)},getReadableContrastingColor:function(bgColor,minContrast){if(!bgColor instanceof Color){return this}
var targetContrast=(minContrast===undef)?5:minContrast;var contrast=bgColor.getDistanceLuminosityFrom(this);var maxContrastColor=bgColor.getMaxContrastColor();var maxContrast=maxContrastColor.getDistanceLuminosityFrom(bgColor);if(maxContrast<=targetContrast){return maxContrastColor}
else if(contrast>=targetContrast){return this}
var incr=(0===maxContrastColor.toInt())?-1:1;while(contrast<targetContrast){this.l(incr,!0);contrast=this.getDistanceLuminosityFrom(bgColor);if(this._color===0||this._color===16777215){break}}
return this},a:function(val){if(val===undef)
return this._alpha;var a=parseFloat(val);if(isNaN(a))
return this._error();this._alpha=a;return this},darken:function(amount){amount=amount||5;return this.l(-amount,!0)},lighten:function(amount){amount=amount||5;return this.l(amount,!0)},saturate:function(amount){amount=amount||15;return this.s(amount,!0)},desaturate:function(amount){amount=amount||15;return this.s(-amount,!0)},toGrayscale:function(){return this.setHSpace('hsl').s(0)},getComplement:function(){return this.h(180,!0)},getSplitComplement:function(step){step=step||1;var incr=180+(step*30);return this.h(incr,!0)},getAnalog:function(step){step=step||1;var incr=step*30;return this.h(incr,!0)},getTetrad:function(step){step=step||1;var incr=step*60;return this.h(incr,!0)},getTriad:function(step){step=step||1;var incr=step*120;return this.h(incr,!0)},_partial:function(key){var prop=shortProps[key];return function(val,incr){var color=this._spaceFunc('to',prop.space);if(val===undef)
return color[key];if(incr===!0)
val=color[key]+val;if(prop.mod)
val=val%prop.mod;if(prop.range)
val=(val<prop.range[0])?prop.range[0]:(val>prop.range[1])?prop.range[1]:val;color[key]=val;return this._spaceFunc('from',prop.space,color)}},_spaceFunc:function(dir,s,val){var space=s||this._hSpace,funcName=dir+space.charAt(0).toUpperCase()+space.substr(1);return this[funcName](val)}};var shortProps={h:{mod:360},s:{range:[0,100]},l:{space:'hsl',range:[0,100]},v:{space:'hsv',range:[0,100]},r:{space:'rgb',range:[0,255]},g:{space:'rgb',range:[0,255]},b:{space:'rgb',range:[0,255]}};for(var key in shortProps){if(shortProps.hasOwnProperty(key))
Color.fn[key]=Color.fn._partial(key)}
if(typeof exports==='object')
module.exports=Color;else global.Color=Color}(this))